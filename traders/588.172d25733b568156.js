"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[588],{588:(I,m,s)=>{s.r(m),s.d(m,{BillPrintModule:()=>J});var d=s(6895),h=s(4575),f=s(5439),C=s(9646),Z=s(4351),y=s(4004),P=s(8746),t=s(4650),T=s(2566),A=s(433),M=s(5259),_=s(1949);function b(e,r){1&e&&(t.TgZ(0,"h3",5),t._uU(1,"No Bills"),t.qZA())}function U(e,r){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.continue)}}function v(e,r){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.second)}}function B(e,r){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.third)}}function O(e,r){if(1&e&&(t.TgZ(0,"tr")(1,"td",19),t._uU(2,"\xa0\xa0\xa0"),t.TgZ(3,"strong",20),t._uU(4),t.qZA(),t._uU(5,"\xa0"),t.TgZ(6,"strong",20),t._uU(7),t.qZA()(),t.TgZ(8,"td",19),t._uU(9),t.qZA(),t.TgZ(10,"td",20),t._uU(11),t.qZA(),t.TgZ(12,"td",21),t._uU(13),t.qZA(),t.TgZ(14,"td",21),t._uU(15),t.qZA()()),2&e){const n=r.$implicit;t.xp6(4),t.hij("",n.no,"."),t.xp6(3),t.Oqu(n.vegetable_name),t.xp6(2),t.Oqu(n.notes),t.xp6(2),t.Oqu(n.quantity),t.xp6(2),t.hij("",n.rate,"/-"),t.xp6(2),t.hij("",n.total_amount,"\xa0\xa0\xa0\xa0")}}function q(e,r){if(1&e&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t._UZ(6,"td")(7,"td")(8,"td"),t.qZA()),2&e){const n=r.$implicit;t.xp6(2),t.hij("\xa0\xa0\xa0\xa0",t.xi3(3,2,n.collection_date,"dd/MM/yyyy"),""),t.xp6(3),t.Oqu(n.amount)}}function D(e,r){if(1&e&&(t.TgZ(0,"div",8)(1,"table",9)(2,"tr")(3,"td",10)(4,"span",11),t._uU(5,"SRI SAINATH TRADERS"),t.qZA(),t._uU(6,"\xa0\xa0\xa0\xa09640443322,\xa09640443322"),t.qZA()(),t.TgZ(7,"tr")(8,"td"),t._uU(9,"\xa0\xa0\xa0"),t.TgZ(10,"span",12),t._uU(11),t.ALo(12,"uppercase"),t.qZA(),t._UZ(13,"br"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t.YNc(16,U,2,1,"span",4),t.YNc(17,v,2,1,"span",4),t.YNc(18,B,2,1,"span",4),t.qZA(),t.TgZ(19,"td",13)(20,"span"),t._uU(21),t.qZA(),t._uU(22),t.ALo(23,"date"),t.qZA()(),t.TgZ(24,"tr")(25,"td",14),t._UZ(26,"hr",15),t.qZA()()(),t.TgZ(27,"table",9),t.YNc(28,O,16,6,"tr",16),t.TgZ(29,"tr")(30,"td"),t._uU(31,"\xa0\xa0\xa0"),t.TgZ(32,"span",17),t._uU(33,"Last 2 Collections"),t.qZA()(),t._UZ(34,"td")(35,"td")(36,"td"),t.TgZ(37,"td",18),t._uU(38),t.qZA()(),t.YNc(39,q,9,5,"tr",16),t.TgZ(40,"tr"),t._UZ(41,"td")(42,"td")(43,"td")(44,"td"),t.TgZ(45,"td",18),t._uU(46),t.qZA(),t._UZ(47,"td"),t.qZA(),t.TgZ(48,"tr"),t._UZ(49,"td")(50,"td")(51,"td")(52,"td"),t.TgZ(53,"td",18),t._uU(54),t.qZA()()()()),2&e){const n=r.$implicit,i=t.oxw(2);t.xp6(11),t.Oqu(t.lcZ(12,12,n.customer_name)),t.xp6(3),t.hij("\xa0\xa0\xa0Ph. ",n.phone_number,""),t.xp6(2),t.Q6J("ngIf",""!==n.continue),t.xp6(1),t.Q6J("ngIf",n.second),t.xp6(1),t.Q6J("ngIf",n.third),t.xp6(3),t.Oqu(0===i.day?"Sun,":1===i.day?"Mon,":2===i.day?"Tue,":3===i.day?"Wed,":4===i.day?"Thu,":5===i.day?"Fri,":6===i.day?"Sat,":""),t.xp6(1),t.hij(" ",t.xi3(23,14,i.date,"dd-MM-yyyy"),"\xa0\xa0\xa0\xa0 "),t.xp6(6),t.Q6J("ngForOf",n.records),t.xp6(10),t.hij("",n.total_amount,"\xa0\xa0\xa0\xa0"),t.xp6(1),t.Q6J("ngForOf",n.collectionData),t.xp6(7),t.hij("",n.balance,"\xa0\xa0\xa0\xa0"),t.xp6(8),t.hij("",n.total_amount,"\xa0\xa0\xa0\xa0")}}function S(e,r){if(1&e&&(t.TgZ(0,"body")(1,"div",6),t.YNc(2,D,55,17,"div",7),t.qZA()()),2&e){const n=t.oxw();t.xp6(2),t.Q6J("ngForOf",n.finalArray)}}const w=[{path:"",component:(()=>{class e{constructor(n){this.mainService=n,this.isVisible=!1,this.todayDate="",this.day=0,this.tablestring="",this.printData=[],this.collectionsData=[],this.date=new Date,this.maxCount=2,this.breakCount=10,this.finalArray=[]}ngOnInit(){const n=new Date;this.day=this.date.getDay(),this.todayDate=f(n).format("DD-MM-YYYY"),this.printCustomerBills()}showModal(){this.isVisible=!0}handleOk(){this.isVisible=!1}handleCancel(){this.isVisible=!1}print(){window.open()}getCollectionsByCustomerId(n){this.mainService.getCollectionsByCustomerId(n).subscribe(i=>{let l=[];i&&i.length>0&&(l.push(i[0]),l.push(i[1])),this.printData.forEach(a=>{a.cusomer_id===n&&(a.collections=l)})},i=>(console.log("get customers err ",i),i))}onReturnDesiredCount(n,i){for(let a of i);}returnSum(n){return n.reduce((i,l)=>l.total_amount+i,0)}maxRecordsCount(n){let l=[];n.forEach((o,x)=>{if(o.records.forEach((p,g)=>{p.no=g+1}),console.log("dataObject.records.length: ",o.records.length),o.records.length>this.breakCount+1){let p=o.records.slice(0,this.breakCount),g=o.records.slice(this.breakCount),u={...o};u.records=p,o.records.length>9&&(u.continue="Continue...");let c={...o};c.records=g,o.records.length>18&&(c.continue=""),c.total_amount=this.returnSum(c.records),u.total_amount=this.returnSum(u.records),l.push(u),l.push(c)}else o.total_amount=this.returnSum(o.records),l.push(o)}),this.finalArray=l,l.some(o=>o.records.length>this.breakCount+1)?this.maxRecordsCount(this.finalArray):this.mainService.spinning.emit(!1)}printCustomerBills(){this.day=this.date.getDay();const l={skip:0,limit:1e3,bill_date:f(this.date).format("YYYY-MM-DD")};this.mainService.spinning.emit(!0),this.mainService.printCustomerBills(l).subscribe(a=>{this.mainService.spinning.emit(!1),a&&a.length>0?(this.printData=a,this.printData&&(this.mainService.spinning.emit(!0),(0,C.of)(...this.printData).pipe((0,Z.b)(o=>this.mainService.getCollectionsByCustomerId(o.customer_id).pipe((0,y.U)(x=>({item:o,data:x})))),(0,P.x)(()=>{this.maxRecordsCount(a)})).subscribe(o=>{o.item.collectionData=o.data}))):this.finalArray=[],this.mainService.spinning.emit(!1)},a=>{console.log("get customers err ",a),this.mainService.spinning.emit(!1)})}onChange(n){this.finalArray=[],this.printCustomerBills()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(T.J))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-bill-print"]],decls:8,vars:4,consts:[[1,"header-print"],[1,"date-picker"],[3,"ngModel","nzAllowClear","ngModelChange"],["class","text-center",4,"ngIf"],[4,"ngIf"],[1,"text-center"],[1,"container"],["class","bill",4,"ngFor","ngForOf"],[1,"bill"],[2,"width","100%"],["colspan","3",1,"text-center"],[1,"shop-title"],[1,"bill_customer_name"],[2,"text-align","right"],["colspan","3",2,"width","100%"],[2,"border","1px dashed #000"],[4,"ngFor","ngForOf"],[2,"text-decoration","underline"],[1,"number",2,"border-top","1px dashed #000"],[1,"upper-case"],[1,"bill_item_name"],[1,"number","bill_item_name"]],template:function(n,i){1&n&&(t.TgZ(0,"h2",0),t._uU(1,"Bill Print"),t.qZA(),t.TgZ(2,"div",1),t._UZ(3,"br"),t.TgZ(4,"nz-date-picker",2),t.NdJ("ngModelChange",function(a){return i.date=a})("ngModelChange",function(a){return i.onChange(a)}),t.qZA(),t._UZ(5,"br"),t.qZA(),t.YNc(6,b,2,0,"h3",3),t.YNc(7,S,3,1,"body",4)),2&n&&(t.xp6(4),t.Q6J("ngModel",i.date)("nzAllowClear",!1),t.xp6(2),t.Q6J("ngIf",i.finalArray&&0===i.finalArray.length),t.xp6(1),t.Q6J("ngIf",i.finalArray&&i.finalArray.length>0))},dependencies:[d.sg,d.O5,A.JJ,A.On,M.uw,_.Uo,_.$Z,d.gd,d.uU],styles:[".shop-title[_ngcontent-%COMP%]{color:#06f706;font-weight:700;font-size:14px}.print-box-width[_ngcontent-%COMP%]{width:386px;height:365px}body[_ngcontent-%COMP%]{margin:0;padding:0}.container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,2fr);grid-gap:20px}.bill[_ngcontent-%COMP%]{width:396.85px;height:374.7px;border:1px solid #000;padding:5px;box-sizing:border-box;page-break-inside:avoid}tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;padding:0}.number[_ngcontent-%COMP%]{text-align:right!important}.upper-case[_ngcontent-%COMP%]{text-transform:uppercase}@page{size:A4;margin:5mm 5mm 5mm -8mm}@media print{body[_ngcontent-%COMP%]{width:0;height:0}.container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,2fr);margin:0;padding:0}.bill[_ngcontent-%COMP%]{width:396.85px;height:370.7px;border:1px solid #000;box-sizing:border-box;page-break-inside:avoid}.header-print[_ngcontent-%COMP%], .date-picker[_ngcontent-%COMP%]{display:none}}h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{text-align:center}.header-print[_ngcontent-%COMP%]{margin-top:10px}.bill_customer_name[_ngcontent-%COMP%]{font-weight:700;font-size:13px;color:#df7c24}.bill_item_name[_ngcontent-%COMP%]{font-weight:600;font-size:12px}.width_customs[_ngcontent-%COMP%]{width:50px}"]}),e})()}];let z=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[h.Bz.forChild(w),h.Bz]}),e})();var Y=s(9912);let J=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.ez,Y.m,z]}),e})()}}]);