"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[91],{16091:(G,z,o)=>{o.r(z),o.d(z,{FarmerModule:()=>k});var u=o(36895),f=o(64575),m=o(90433),x=o(94327),p=o(80574),e=o(94650),F=o(49651),v=o(31883),T=o(32566),S=o(37570),Z=o(21102),h=o(73679),d=o(36704),g=o(35635),_=o(38231),C=o(66616),A=o(47044),N=o(21811),l=o(44688),b=o(6497),P=o(21634);function J(r,i){1&r&&(e.TgZ(0,"nz-select",33),e._UZ(1,"nz-option",34),e.qZA())}function y(r,i){if(1&r){const n=e.EpF();e.TgZ(0,"span",36),e.NdJ("click",function(){e.CHM(n);const a=e.oxw(3);return e.KtG(a.clearfield("address"))}),e.qZA()}}function O(r,i){if(1&r&&e.YNc(0,y,1,0,"span",35),2&r){const n=e.oxw(2);e.Q6J("ngIf",n.validateForm.controls.address.value)}}function U(r,i){if(1&r){const n=e.EpF();e.TgZ(0,"span",36),e.NdJ("click",function(){e.CHM(n);const a=e.oxw(3);return e.KtG(a.clearfield("notes"))}),e.qZA()}}function E(r,i){if(1&r&&e.YNc(0,U,1,0,"span",35),2&r){const n=e.oxw(2);e.Q6J("ngIf",n.validateForm.controls.notes.value)}}function I(r,i){if(1&r){const n=e.EpF();e.TgZ(0,"form",11),e.NdJ("ngSubmit",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.submitForm())}),e.TgZ(1,"nz-form-item")(2,"nz-form-label",12)(3,"span"),e._uU(4,"Name"),e.qZA()(),e.TgZ(5,"nz-form-control",13),e._UZ(6,"input",14),e.qZA()(),e.TgZ(7,"nz-form-item")(8,"nz-form-label",15),e._uU(9,"Phone Number"),e.qZA(),e.TgZ(10,"nz-form-control",16)(11,"nz-input-group",17),e.YNc(12,J,2,0,"ng-template",null,18,e.W1O),e._UZ(14,"input",19),e.qZA()()(),e.TgZ(15,"nz-form-item")(16,"nz-form-label",20),e._uU(17,"Address"),e.qZA(),e.TgZ(18,"nz-form-control",21)(19,"nz-input-group",22),e._UZ(20,"textarea",23),e.qZA(),e.YNc(21,O,1,1,"ng-template",null,24,e.W1O),e.qZA()(),e.TgZ(23,"nz-form-item")(24,"nz-form-label",25),e._uU(25,"Notes"),e.qZA(),e.TgZ(26,"nz-form-control",26)(27,"nz-input-group",22),e._UZ(28,"textarea",27),e.qZA(),e.YNc(29,E,1,1,"ng-template",null,28,e.W1O),e.qZA()(),e.TgZ(31,"nz-form-item",29)(32,"nz-form-control",30)(33,"button",31),e._uU(34),e.qZA(),e._uU(35,"\xa0 "),e.TgZ(36,"button",32),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.reset())}),e._uU(37,"Reset"),e.qZA()()()()}if(2&r){const n=e.MAs(13),t=e.MAs(22),a=e.MAs(30),s=e.oxw();e.Q6J("formGroup",s.validateForm),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(3),e.Q6J("nzSm",14)("nzXs",24),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",s.validateForm.controls.phoneNumber),e.xp6(1),e.Q6J("nzAddOnBefore",n),e.xp6(3),e.Q6J("maxlength",10),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",s.validateForm.controls.address),e.xp6(1),e.Q6J("nzSuffix",t),e.xp6(5),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",s.validateForm.controls.notes),e.xp6(1),e.Q6J("nzSuffix",a),e.xp6(5),e.Q6J("nzSpan",14)("nzOffset",6),e.xp6(1),e.Q6J("disabled",!s.validateForm.valid),e.xp6(1),e.Oqu(s.edit?"Update":"Create")}}function Q(r,i){if(1&r){const n=e.EpF();e.TgZ(0,"a",42),e.NdJ("click",function(){e.CHM(n);const a=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.editFarmer(a))}),e._UZ(1,"span",43),e.qZA()}}function M(r,i){if(1&r){const n=e.EpF();e.TgZ(0,"a",44),e.NdJ("nzOnConfirm",function(){e.CHM(n);const a=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.confirm(a._id))})("nzOnCancel",function(){e.CHM(n);const a=e.oxw(3);return e.KtG(a.cancel())}),e._UZ(1,"span",45),e.qZA()}}function q(r,i){if(1&r&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e.YNc(10,Q,2,0,"a",40),e._uU(11,"\xa0\xa0 "),e.YNc(12,M,2,0,"a",41),e.qZA()()),2&r){const n=i.$implicit,t=e.oxw(2);e.xp6(2),e.Oqu(n.name),e.xp6(2),e.Oqu(n.phone_number),e.xp6(2),e.Oqu(n.address),e.xp6(2),e.Oqu(n.notes),e.xp6(2),e.Q6J("ngIf","admin"===t.userinfo.username||t.userinfo.apps.farmer&&t.userinfo.apps.farmer.isEdit),e.xp6(2),e.Q6J("ngIf","admin"===t.userinfo.username||t.userinfo.apps.farmer&&t.userinfo.apps.farmer.isEdit)}}function w(r,i){if(1&r&&(e.TgZ(0,"nz-table",37,38)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"Name"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Phone Number"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Address"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Notes"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Actions"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,q,13,6,"tr",39),e.qZA()()),2&r){const n=e.oxw();e.Q6J("nzData",n.farmersData)("nzShowPagination",!1)("nzLoading",n.loading),e.xp6(15),e.Q6J("ngForOf",n.farmersData)}}const B=[{path:"",component:(()=>{class r{constructor(n,t,a,s,c){this.fb=n,this.message=t,this.farmerService=a,this.mainService=s,this.router=c,this.farmersData=[],this.sort=["ascend"],this.listOfColumns=[{name:"Name"},{phoneNumber:"Phone Number"},{address:"Address"},{notes:"Note"}],this.index=1,this.total=0,this.pageSize=10,this.loading=!0,this.edit=!1,this.farmerId="",this.userinfo=this.mainService.getLoggedInUser(),this.userinfo||(sessionStorage.clear(),this.message.create("warning","User session expired please login"),this.router.navigateByUrl("/login"))}ngOnInit(){this.validateForm=this.fb.group({name:[null,[m.kI.required]],phoneNumberPrefix:["+91"],phoneNumber:[null],address:[null],notes:[null]}),this.getAllFarmers()}getAllFarmers(){this.loading=!0;const n={skip:this.index,limit:this.pageSize};document.getElementById("farmerName")?.focus(),this.farmerService.getFarmers(n).subscribe(t=>{this.farmersData=t.data,this.total=t.total,this.loading=!1},t=>{console.log("get farmers err ",t),this.farmersData=[],this.loading=!1})}clearfield(n){this.validateForm.controls[n].reset()}submitForm(){if(this.validateForm.valid){const n={name:this.validateForm.value.name,phone_number:this.validateForm.value.phoneNumber?parseInt(this.validateForm.value.phoneNumber):null,address:this.validateForm.value.address,notes:this.validateForm.value.notes};this.mainService.spinning.emit(!0),this.edit?this.mainService.updateFarmer(this.farmerId,n).subscribe(t=>{this.message.create("success",`${this.validateForm.value.name} farmer updated Successfully`),this.reset(),this.loading=!0,this.edit=!1,this.mainService.spinning.emit(!1),this.getAllFarmers()},t=>{console.log("get customers err ",t),this.loading=!1,this.mainService.spinning.emit(!1),this.getAllFarmers()}):this.mainService.createFarmer(n).subscribe(t=>{this.message.create("success",`${this.validateForm.value.name} farmer added Successfully`),this.reset(),this.loading=!0,this.mainService.spinning.emit(!1),this.getAllFarmers()},t=>{console.log("get customers err ",t),this.loading=!1,this.mainService.spinning.emit(!1),this.getAllFarmers()})}else this.mainService.spinning.emit(!1),Object.values(this.validateForm.controls).forEach(n=>{n.invalid&&(n.markAsDirty(),n.updateValueAndValidity({onlySelf:!0}))})}editFarmer(n){this.edit=!0,this.farmerId=n._id,this.validateForm.controls.phoneNumber.setValue(n.phone_number),this.validateForm.controls.name.setValue(n.name),this.validateForm.controls.notes.setValue(n.notes),this.validateForm.controls.address.setValue(n.address)}confirm(n){this.mainService.removeFarmer(n).subscribe(t=>{this.loading=!1,t&&t.success&&(this.message.create("success",t.message),this.getAllFarmers())},t=>{console.log("get customers err ",t),this.loading=!1})}cancel(){}exportJsonAsExcelFile(n,t){const s={Sheets:{data:p.P6.json_to_sheet(n)},SheetNames:["data"]},c=p.cW(s,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(c,t)}exportTableAsExcelFile(n,t){const s={Sheets:{data:p.P6.table_to_sheet(n)},SheetNames:["data"]},c=p.cW(s,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(c,t)}saveAsExcelFile(n,t){const a=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});x.saveAs(a,t+(new Date).getTime()+".xlsx")}exportToExcel(){let n=[];this.farmersData.forEach(t=>{n.push({Name:t.name,"Phone Number":t.phone_number,Address:t.address,Notes:t.notes})}),this.exportJsonAsExcelFile(n,"farmers")}reset(){this.validateForm.controls.name.reset(),this.validateForm.controls.phoneNumber.reset(),this.validateForm.controls.address.reset(),this.validateForm.controls.notes.reset(),this.edit=!1}onPageSizeChange(n){this.pageSize=n,this.getAllFarmers()}onPageChange(n){this.index=n,this.getAllFarmers()}}return r.\u0275fac=function(n){return new(n||r)(e.Y36(m.QS),e.Y36(F.dD),e.Y36(v.y),e.Y36(T.J),e.Y36(f.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-farmer"]],decls:17,vars:6,consts:[[1,"customer-form"],["nz-row",""],["nz-col","","nzSpan","24"],[1,"text-center"],["nz-col","","nzSpan","12"],["nz-form","",3,"formGroup","ngSubmit",4,"ngIf"],["nz-tooltip","","nzTooltipTitle","Export as Excel",3,"click"],["nz-icon","","nzType","file-excel","nzTheme","fill"],[3,"nzData","nzShowPagination","nzLoading",4,"ngIf"],[1,"text-right"],[3,"nzPageIndex","nzTotal","nzShowSizeChanger","nzPageSize","nzPageIndexChange","nzPageSizeChange"],["nz-form","",3,"formGroup","ngSubmit"],["nzFor","farmerName","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your name!",3,"nzSm","nzXs"],["nz-input","","id","farmerName","formControlName","name","placeholder","Name","autocomplete","off"],["nzFor","phoneNumber",3,"nzSm","nzXs"],["nzErrorTip","Please input your phone number!",3,"nzSm","nzXs","nzValidateStatus"],[3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","phoneNumber","id","'phoneNumber'","nz-input","","autocomplete","off",3,"maxlength"],["nzFor","address",3,"nzSm","nzXs"],["nzErrorTip","Please input your address!",3,"nzSm","nzXs","nzValidateStatus"],[1,"ant-input-affix-wrapper-textarea-with-clear-btn",3,"nzSuffix"],["nz-input","","formControlName","address","placeholder","Address"],["textAreaClearTpl",""],["nzFor","notes",3,"nzSm","nzXs"],["nzErrorTip","Please input your notes!",3,"nzSm","nzXs","nzValidateStatus"],["nz-input","","formControlName","notes","placeholder","Notes"],["textAreaClearNotes",""],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"disabled"],["nz-button","","nzType","default",3,"click"],["nzShowSearch","","nzAllowClear","","nzDisabled","","formControlName","phoneNumberPrefix",1,"phone-select"],["nzLabel","+91","nzValue","+91"],["nz-icon","","class","ant-input-clear-icon","nzTheme","fill","nzType","close-circle",3,"click",4,"ngIf"],["nz-icon","","nzTheme","fill","nzType","close-circle",1,"ant-input-clear-icon",3,"click"],[3,"nzData","nzShowPagination","nzLoading"],["basicTable",""],[4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure delete this Farmer","nzPopconfirmPlacement","bottom",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],[3,"click"],["nz-icon","","nzType","edit","nzTheme","fill"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure delete this Farmer","nzPopconfirmPlacement","bottom",3,"nzOnConfirm","nzOnCancel"],["nz-icon","","nzType","delete","nzTheme","fill"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e._uU(4,"Farmers"),e.qZA()()(),e.TgZ(5,"div",1)(6,"div",4),e.YNc(7,I,38,28,"form",5),e.qZA(),e.TgZ(8,"div",4)(9,"div")(10,"a",6),e.NdJ("click",function(){return t.exportToExcel()}),e._UZ(11,"span",7),e.qZA()(),e.YNc(12,w,16,4,"nz-table",8),e.TgZ(13,"div",9),e._UZ(14,"br"),e.TgZ(15,"nz-pagination",10),e.NdJ("nzPageIndexChange",function(s){return t.onPageChange(s)})("nzPageSizeChange",function(s){return t.onPageSizeChange(s)}),e.qZA(),e._UZ(16,"br"),e.qZA()()()()),2&n&&(e.xp6(7),e.Q6J("ngIf","admin"===t.userinfo.username||t.userinfo.apps.farmer&&t.userinfo.apps.farmer.isEdit),e.xp6(5),e.Q6J("ngIf",t.farmersData),e.xp6(3),e.Q6J("nzPageIndex",t.index)("nzTotal",t.total)("nzShowSizeChanger",!0)("nzPageSize",t.pageSize))},dependencies:[u.sg,u.O5,S.SY,Z.Ls,h.t3,h.SK,d.Lr,d.Nx,d.iK,d.Fd,m._Y,m.Fj,m.JJ,m.JL,m.nD,m.sg,m.u,g.Zp,g.gB,g.ke,_.Ip,_.Vq,C.ix,A.w,N.dQ,l.N8,l.Uo,l._C,l.Om,l.p0,l.$Z,b.JW,P.dE],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}.customer-form[_ngcontent-%COMP%]{margin-top:20px}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-right[_ngcontent-%COMP%]{text-align:right!important}"]}),r})()}];let D=(()=>{class r{}return r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[f.Bz.forChild(B),f.Bz]}),r})();var V=o(4973);let k=(()=>{class r{}return r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[u.ez,D,V.m]}),r})()}}]);