"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[380],{67928:(E,u,r)=>{r.r(u),r.d(u,{ReportCollectionsModule:()=>U});var m=r(36895),g=r(4973),c=r(64575),i=r(90433),t=r(94650),h=r(49651),C=r(32566),v=r(30901),x=r(31883),S=r(21102),z=r(73679),l=r(36704),p=r(35635),d=r(38231),F=r(66616),_=r(47044),A=r(21811),T=r(37096),f=r(44688);function Z(o,s){if(1&o&&t._UZ(0,"nz-option",23),2&o){const e=s.$implicit;t.Q6J("nzLabel",e)("nzValue",e)}}function b(o,s){1&o&&(t.TgZ(0,"nz-form-item")(1,"nz-form-label",24)(2,"span"),t._uU(3,"Spent Amount"),t.qZA()(),t.TgZ(4,"nz-form-control",7),t._UZ(5,"nz-input-number",25),t.qZA()()),2&o&&(t.xp6(1),t.Q6J("nzSm",6)("nzXs",24),t.xp6(3),t.Q6J("nzSm",14)("nzXs",24),t.xp6(1),t.Q6J("nzMin",1)("nzStep",1))}function J(o,s){if(1&o&&t._UZ(0,"nz-option",23),2&o){const e=s.$implicit;t.Q6J("nzLabel",e.name)("nzValue",e)}}function y(o,s){if(1&o&&(t.TgZ(0,"table",26)(1,"tr")(2,"td")(3,"nz-form-item",27)(4,"nz-form-label",28)(5,"span"),t._uU(6,"Farmer"),t.qZA()(),t.TgZ(7,"nz-form-control",9)(8,"nz-select",29),t.YNc(9,J,1,2,"nz-option",11),t.qZA()()()(),t.TgZ(10,"td")(11,"nz-form-item",30)(12,"nz-form-label",31)(13,"span"),t._uU(14,"Spent Amount"),t.qZA()(),t.TgZ(15,"nz-form-control",7),t._UZ(16,"nz-input-number",25),t.qZA()()()()()),2&o){const e=t.oxw();t.xp6(4),t.Q6J("nzSm",6)("nzXs",24),t.xp6(3),t.Q6J("nzSm",14)("nzXs",24),t.xp6(1),t.Q6J("nzAutoFocus",!0),t.xp6(1),t.Q6J("ngForOf",e.farmersData),t.xp6(3),t.Q6J("nzSm",6)("nzXs",24),t.xp6(3),t.Q6J("nzSm",14)("nzXs",24),t.xp6(1),t.Q6J("nzMin",1)("nzStep",1)}}function R(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"span",33),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.clearfield("notes"))}),t.qZA()}}function N(o,s){if(1&o&&t.YNc(0,R,1,0,"span",32),2&o){const e=t.oxw();t.Q6J("ngIf",e.validateForm.controls.notes.value)}}const Q=[{path:"",component:(()=>{class o{constructor(e,n,a,M,O,I){this.fb=e,this.message=n,this.mainService=a,this.exportAsService=M,this.router=O,this.farmerService=I,this.customersData=[],this.sort=["ascend"],this.listOfColumns=[{name:"Name"},{phoneNumber:"Phone Number"},{address:"Address"},{notes:"Note"}],this.index=1,this.total=0,this.pageSize=10,this.loading=!1,this.edit=!1,this.downloadAs="pdf",this.exportAsConfig={type:"pdf",elementIdOrContent:"sampleTable"},this.customers=[],this.reasonTypes=["Petrol","Farmer","Transport","Cooli"],this.userinfo=this.mainService.getLoggedInUser(),console.log("this.userinfo: ",this.userinfo),this.validateForm=this.fb.group({amount:[null,[i.kI.required]],reason_type:[null],reason_amount:[null],notes:[null],farmer:[null]}),this.validateForm.controls.reason_type.valueChanges.subscribe(P=>{console.log("data: ",P),this.validateForm.controls.reason_amount.reset(),this.validateForm.controls.farmer.reset()})}ngOnInit(){this.getAllFarmers()}submitForm(){console.log("this.validateForm value: ",this.validateForm.value)}clearfield(e){this.validateForm.controls[e].reset()}reset(){this.validateForm.controls.amount.reset(),this.validateForm.controls.reason_type.reset(),this.validateForm.controls.reason_amount.reset(),this.validateForm.controls.farmer.reset(),this.validateForm.controls.notes.reset()}exportToExcel(){let e=[];this.customersData.forEach(a=>{e.push({Name:a.name,"Phone Number":a.phone_number,Address:a.address,Notes:a.notes})}),this.exportAsConfig.type=this.downloadAs,this.exportAsConfig.elementIdOrContent="<table><thead><tr><th>Name</th><th>Balance Amount</th><th>Paid Amount</th></tr></thead><tbody><tr><td>Rajesh</td><td>1500</td><td>500</td></tr><tr><td>Customer1</td><td>0</td><td>0</td></tr></tbody></table>",this.exportAsConfig.options={margins:{top:"50"}},this.exportAsService.save(this.exportAsConfig,"customers").subscribe(()=>{})}editCustomer(e){this.edit=!0,this.customerId=e._id,this.validateForm.controls.phoneNumber.setValue(e.phone_number),this.validateForm.controls.name.setValue(e.name),this.validateForm.controls.notes.setValue(e.notes),this.validateForm.controls.address.setValue(e.address)}deleteConfirm(e){this.mainService.removeCustomer(e).subscribe(n=>{this.loading=!1,n&&n.success?this.message.create("success",n.message):n.success||this.message.create("warning",n.message)},n=>{console.log("get customers err ",n),this.loading=!1,n&&n.error&&!n.error.success&&1e3===n.error.code&&(this.message.create("error",n.error.message),sessionStorage.clear(),this.router.navigateByUrl("/login"))})}cancel(){}onPageSizeChange(e){this.pageSize=e}onPageChange(e){this.index=e}getAllFarmers(){document.getElementById("farmerName")?.focus(),this.farmerService.getFarmers({}).subscribe(n=>{this.farmersData=n.data,this.total=n.total},n=>{console.log("get farmers err ",n),this.farmersData=[],n&&n.error&&!n.error.success&&1e3===n.error.code&&(this.message.create("error",n.error.message),sessionStorage.clear(),this.router.navigateByUrl("/login"))})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(i.QS),t.Y36(h.dD),t.Y36(C.J),t.Y36(v.f),t.Y36(c.F0),t.Y36(x.y))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-report-collections"]],decls:38,vars:25,consts:[[1,"customer-form"],["nz-row",""],["nz-col","","nzSpan","24"],[1,"text-center"],["nz-col","","nzSpan","12"],["nz-form","",3,"formGroup","ngSubmit"],["nzFor","amount","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Enter Amount",3,"nzSm","nzXs"],["id","amount","formControlName","amount",3,"nzMin","nzStep"],[3,"nzSm","nzXs"],["nzShowSearch","","nzAllowClear","","formControlName","reason_type",3,"nzAutoFocus"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[4,"ngIf"],["class","reason_type_custom",4,"ngIf"],["nzFor","notes",3,"nzSm","nzXs"],["nzErrorTip","Please input your notes!",3,"nzSm","nzXs","nzValidateStatus"],[1,"ant-input-affix-wrapper-textarea-with-clear-btn",3,"nzSuffix"],["nz-input","","formControlName","notes","placeholder","Notes"],["textAreaClearNotes",""],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"disabled"],["nz-button","","nzType","default",3,"click"],[3,"nzLabel","nzValue"],["nzFor","reason_amount",3,"nzSm","nzXs"],["id","reason_amount","formControlName","reason_amount",3,"nzMin","nzStep"],[1,"reason_type_custom"],[2,"width","350px"],["nzRequired","",3,"nzSm","nzXs"],["nzShowSearch","","nzAllowClear","","formControlName","farmer",3,"nzAutoFocus"],[2,"width","445px"],["nzFor","reason_amount","nzRequired","",3,"nzSm","nzXs"],["nz-icon","","class","ant-input-clear-icon","nzTheme","fill","nzType","close-circle",3,"click",4,"ngIf"],["nz-icon","","nzTheme","fill","nzType","close-circle",1,"ant-input-clear-icon",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"Collection Report"),t.qZA()()(),t.TgZ(5,"div",1)(6,"div",4)(7,"form",5),t.NdJ("ngSubmit",function(){return n.submitForm()}),t.TgZ(8,"nz-form-item")(9,"nz-form-label",6)(10,"span"),t._uU(11,"Amount"),t.qZA()(),t.TgZ(12,"nz-form-control",7),t._UZ(13,"nz-input-number",8),t.qZA()(),t.TgZ(14,"nz-form-item")(15,"nz-form-label",9)(16,"span"),t._uU(17,"Reason Type"),t.qZA()(),t.TgZ(18,"nz-form-control",9)(19,"nz-select",10),t.YNc(20,Z,1,2,"nz-option",11),t.qZA()()(),t.YNc(21,b,6,6,"nz-form-item",12),t.YNc(22,y,17,12,"table",13),t.TgZ(23,"nz-form-item")(24,"nz-form-label",14),t._uU(25,"Notes"),t.qZA(),t.TgZ(26,"nz-form-control",15)(27,"nz-input-group",16),t._UZ(28,"textarea",17),t.qZA(),t.YNc(29,N,1,1,"ng-template",null,18,t.W1O),t.qZA()(),t.TgZ(31,"nz-form-item",19)(32,"nz-form-control",20)(33,"button",21),t._uU(34),t.qZA(),t._uU(35,"\xa0 "),t.TgZ(36,"button",22),t.NdJ("click",function(){return n.reset()}),t._uU(37,"Reset"),t.qZA()()()()()()()),2&e){const a=t.MAs(30);t.xp6(7),t.Q6J("formGroup",n.validateForm),t.xp6(2),t.Q6J("nzSm",6)("nzXs",24),t.xp6(3),t.Q6J("nzSm",14)("nzXs",24),t.xp6(1),t.Q6J("nzMin",1)("nzStep",1),t.xp6(2),t.Q6J("nzSm",6)("nzXs",24),t.xp6(3),t.Q6J("nzSm",14)("nzXs",24),t.xp6(1),t.Q6J("nzAutoFocus",!0),t.xp6(1),t.Q6J("ngForOf",n.reasonTypes),t.xp6(1),t.Q6J("ngIf","Farmer"!==n.validateForm.controls.reason_type.value),t.xp6(1),t.Q6J("ngIf","Farmer"===n.validateForm.controls.reason_type.value),t.xp6(2),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",n.validateForm.controls.notes),t.xp6(1),t.Q6J("nzSuffix",a),t.xp6(5),t.Q6J("nzSpan",14)("nzOffset",6),t.xp6(1),t.Q6J("disabled",!n.validateForm.valid),t.xp6(1),t.Oqu(n.edit?"Update":"Submit")}},dependencies:[m.sg,m.O5,S.Ls,z.t3,z.SK,l.Lr,l.Nx,l.iK,l.Fd,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,p.Zp,p.gB,p.ke,d.Ip,d.Vq,F.ix,_.w,A.dQ,T._V,f.Uo,f.$Z],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}.customer-form[_ngcontent-%COMP%]{margin-top:20px}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-right[_ngcontent-%COMP%]{text-align:right!important}.reason_type_custom[_ngcontent-%COMP%]{width:100%;margin-left:10%}"]}),o})()}];let X=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[c.Bz.forChild(Q),c.Bz]}),o})(),U=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.ez,X,g.m]}),o})()}}]);