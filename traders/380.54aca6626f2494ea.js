"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[380],{67928:(w,f,s)=>{s.r(f),s.d(f,{ReportCollectionsModule:()=>X});var p=s(36895),_=s(4973),u=s(64575),l=s(90433),e=s(94650),h=s(49651),C=s(32566),x=s(30901),T=s(37570),Z=s(21102),z=s(73679),c=s(36704),d=s(35635),g=s(38231),A=s(66616),v=s(47044),S=s(21811),m=s(44688),N=s(6497),b=s(21634);function P(t,i){1&t&&(e.TgZ(0,"nz-select",33),e._UZ(1,"nz-option",34),e.qZA())}function J(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"span",36),e.NdJ("click",function(){e.CHM(n);const r=e.oxw(3);return e.KtG(r.clearfield("address"))}),e.qZA()}}function R(t,i){if(1&t&&e.YNc(0,J,1,0,"span",35),2&t){const n=e.oxw(2);e.Q6J("ngIf",n.validateForm.controls.address.value)}}function F(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"span",36),e.NdJ("click",function(){e.CHM(n);const r=e.oxw(3);return e.KtG(r.clearfield("notes"))}),e.qZA()}}function U(t,i){if(1&t&&e.YNc(0,F,1,0,"span",35),2&t){const n=e.oxw(2);e.Q6J("ngIf",n.validateForm.controls.notes.value)}}function O(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"form",11),e.NdJ("ngSubmit",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.submitForm())}),e.TgZ(1,"nz-form-item")(2,"nz-form-label",12)(3,"span"),e._uU(4,"Name"),e.qZA()(),e.TgZ(5,"nz-form-control",13),e._UZ(6,"input",14),e.qZA()(),e.TgZ(7,"nz-form-item")(8,"nz-form-label",15),e._uU(9,"Phone Number"),e.qZA(),e.TgZ(10,"nz-form-control",16)(11,"nz-input-group",17),e.YNc(12,P,2,0,"ng-template",null,18,e.W1O),e._UZ(14,"input",19),e.qZA()()(),e.TgZ(15,"nz-form-item")(16,"nz-form-label",20),e._uU(17,"Address"),e.qZA(),e.TgZ(18,"nz-form-control",21)(19,"nz-input-group",22),e._UZ(20,"textarea",23),e.qZA(),e.YNc(21,R,1,1,"ng-template",null,24,e.W1O),e.qZA()(),e.TgZ(23,"nz-form-item")(24,"nz-form-label",25),e._uU(25,"Notes"),e.qZA(),e.TgZ(26,"nz-form-control",26)(27,"nz-input-group",22),e._UZ(28,"textarea",27),e.qZA(),e.YNc(29,U,1,1,"ng-template",null,28,e.W1O),e.qZA()(),e.TgZ(31,"nz-form-item",29)(32,"nz-form-control",30)(33,"button",31),e._uU(34),e.qZA(),e._uU(35,"\xa0 "),e.TgZ(36,"button",32),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.reset())}),e._uU(37,"Reset"),e.qZA()()()()}if(2&t){const n=e.MAs(13),o=e.MAs(22),r=e.MAs(30),a=e.oxw();e.Q6J("formGroup",a.validateForm),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(3),e.Q6J("nzSm",14)("nzXs",24),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",a.validateForm.controls.phoneNumber),e.xp6(1),e.Q6J("nzAddOnBefore",n),e.xp6(3),e.Q6J("maxlength",10),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",a.validateForm.controls.address),e.xp6(1),e.Q6J("nzSuffix",o),e.xp6(5),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",a.validateForm.controls.notes),e.xp6(1),e.Q6J("nzSuffix",r),e.xp6(5),e.Q6J("nzSpan",14)("nzOffset",6),e.xp6(1),e.Q6J("disabled",!a.validateForm.valid),e.xp6(1),e.Oqu(a.edit?"Update":"Create")}}function y(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"a",42),e.NdJ("click",function(){e.CHM(n);const r=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.editCustomer(r))}),e._UZ(1,"span",43),e.qZA()}}function E(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"a",44),e.NdJ("nzOnConfirm",function(){e.CHM(n);const r=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.deleteConfirm(r._id))})("nzOnCancel",function(){e.CHM(n);const r=e.oxw(3);return e.KtG(r.cancel())}),e._UZ(1,"span",45),e.qZA()}}function Q(t,i){if(1&t&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e.YNc(10,y,2,0,"a",40),e._uU(11,"\xa0\xa0 "),e.YNc(12,E,2,0,"a",41),e.qZA()()),2&t){const n=i.$implicit,o=e.oxw(2);e.xp6(2),e.Oqu(n.name),e.xp6(2),e.Oqu(n.phone_number),e.xp6(2),e.Oqu(n.address),e.xp6(2),e.Oqu(n.notes),e.xp6(2),e.Q6J("ngIf","admin"===o.userinfo.username||o.userinfo.apps.customer&&o.userinfo.apps.customer.isEdit),e.xp6(2),e.Q6J("ngIf","admin"===o.userinfo.username||o.userinfo.apps.customer&&o.userinfo.apps.customer.isEdit)}}function I(t,i){if(1&t&&(e.TgZ(0,"nz-table",37,38)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"Name"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Phone Number"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Address"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Notes"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Actions"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,Q,13,6,"tr",39),e.qZA()()),2&t){const n=e.oxw();e.Q6J("nzData",n.customersData)("nzLoading",n.loading)("nzShowPagination",!1),e.xp6(15),e.Q6J("ngForOf",n.customersData)}}const M=[{path:"",component:(()=>{class t{constructor(n,o,r,a,Y){this.fb=n,this.message=o,this.mainService=r,this.exportAsService=a,this.router=Y,this.customersData=[],this.sort=["ascend"],this.listOfColumns=[{name:"Name"},{phoneNumber:"Phone Number"},{address:"Address"},{notes:"Note"}],this.index=1,this.total=0,this.pageSize=10,this.loading=!1,this.edit=!1,this.downloadAs="pdf",this.exportAsConfig={type:"pdf",elementIdOrContent:"sampleTable"},this.userinfo=this.mainService.getLoggedInUser(),console.log("this.userinfo: ",this.userinfo),this.userinfo?"admin"!==this.userinfo.username&&((this.userinfo.apps.customer.isEdit||this.userinfo.apps.customer.isView)&&this.userinfo.apps.customer.isView||this.router.navigateByUrl("/main")):(sessionStorage.clear(),this.message.create("warning","User session expired please login"),this.router.navigateByUrl("/login"))}ngOnInit(){this.validateForm=this.fb.group({name:[null,[l.kI.required]],phoneNumberPrefix:["+91"],phoneNumber:[null],address:[null],notes:[null]})}submitForm(){}clearfield(n){this.validateForm.controls[n].reset()}reset(){this.validateForm.controls.name.reset(),this.validateForm.controls.phoneNumber.reset(),this.validateForm.controls.address.reset(),this.validateForm.controls.notes.reset(),this.edit=!1,document.getElementById("customerName")?.focus()}exportToExcel(){let n=[];this.customersData.forEach(r=>{n.push({Name:r.name,"Phone Number":r.phone_number,Address:r.address,Notes:r.notes})}),this.exportAsConfig.type=this.downloadAs,this.exportAsConfig.elementIdOrContent="<table><thead><tr><th>Name</th><th>Balance Amount</th><th>Paid Amount</th></tr></thead><tbody><tr><td>Rajesh</td><td>1500</td><td>500</td></tr><tr><td>Customer1</td><td>0</td><td>0</td></tr></tbody></table>",this.exportAsConfig.options={margins:{top:"50"}},this.exportAsService.save(this.exportAsConfig,"customers").subscribe(()=>{})}editCustomer(n){this.edit=!0,this.customerId=n._id,this.validateForm.controls.phoneNumber.setValue(n.phone_number),this.validateForm.controls.name.setValue(n.name),this.validateForm.controls.notes.setValue(n.notes),this.validateForm.controls.address.setValue(n.address)}deleteConfirm(n){this.mainService.removeCustomer(n).subscribe(o=>{this.loading=!1,o&&o.success?this.message.create("success",o.message):o.success||this.message.create("warning",o.message)},o=>{console.log("get customers err ",o),this.loading=!1,o&&o.error&&!o.error.success&&1e3===o.error.code&&(this.message.create("error",o.error.message),sessionStorage.clear(),this.router.navigateByUrl("/login"))})}cancel(){}onPageSizeChange(n){this.pageSize=n}onPageChange(n){this.index=n}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(l.QS),e.Y36(h.dD),e.Y36(C.J),e.Y36(x.f),e.Y36(u.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-report-collections"]],decls:17,vars:6,consts:[[1,"customer-form"],["nz-row",""],["nz-col","","nzSpan","24"],[1,"text-center"],["nz-col","","nzSpan","12"],["nz-form","",3,"formGroup","ngSubmit",4,"ngIf"],["nz-tooltip","","nzTooltipTitle","Export as Excel",3,"click"],["nz-icon","","nzType","file-excel","nzTheme","fill"],[3,"nzData","nzLoading","nzShowPagination",4,"ngIf"],[1,"text-right"],[3,"nzPageIndex","nzTotal","nzShowSizeChanger","nzPageSize","nzPageIndexChange","nzPageSizeChange"],["nz-form","",3,"formGroup","ngSubmit"],["nzFor","customerName","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your name!",3,"nzSm","nzXs"],["nz-input","","id","customerName","formControlName","name","placeholder","Name","autocomplete","off"],["nzFor","phoneNumber",3,"nzSm","nzXs"],["nzErrorTip","Please input your phone number!",3,"nzSm","nzXs","nzValidateStatus"],[3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","phoneNumber","id","'phoneNumber'","nz-input","","autocomplete","off",3,"maxlength"],["nzFor","address",3,"nzSm","nzXs"],["nzErrorTip","Please input your address!",3,"nzSm","nzXs","nzValidateStatus"],[1,"ant-input-affix-wrapper-textarea-with-clear-btn",3,"nzSuffix"],["nz-input","","formControlName","address","placeholder","Address"],["textAreaClearTpl",""],["nzFor","notes",3,"nzSm","nzXs"],["nzErrorTip","Please input your notes!",3,"nzSm","nzXs","nzValidateStatus"],["nz-input","","formControlName","notes","placeholder","Notes"],["textAreaClearNotes",""],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"disabled"],["nz-button","","nzType","default",3,"click"],["formControlName","phoneNumberPrefix","nzDisabled","",1,"phone-select"],["nzLabel","+91","nzValue","+91"],["nz-icon","","class","ant-input-clear-icon","nzTheme","fill","nzType","close-circle",3,"click",4,"ngIf"],["nz-icon","","nzTheme","fill","nzType","close-circle",1,"ant-input-clear-icon",3,"click"],[3,"nzData","nzLoading","nzShowPagination"],["customerTable",""],[4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure delete this Customer","nzPopconfirmPlacement","bottom",3,"nzOnConfirm","nzOnCancel",4,"ngIf"],[3,"click"],["nz-icon","","nzType","edit","nzTheme","fill"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure delete this Customer","nzPopconfirmPlacement","bottom",3,"nzOnConfirm","nzOnCancel"],["nz-icon","","nzType","delete","nzTheme","fill"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e._uU(4,"Collection Report"),e.qZA()()(),e.TgZ(5,"div",1)(6,"div",4),e.YNc(7,O,38,28,"form",5),e.qZA(),e.TgZ(8,"div",4)(9,"div")(10,"a",6),e.NdJ("click",function(){return o.exportToExcel()}),e._UZ(11,"span",7),e.qZA()(),e.YNc(12,I,16,4,"nz-table",8),e.TgZ(13,"div",9),e._UZ(14,"br"),e.TgZ(15,"nz-pagination",10),e.NdJ("nzPageIndexChange",function(a){return o.onPageChange(a)})("nzPageSizeChange",function(a){return o.onPageSizeChange(a)}),e.qZA(),e._UZ(16,"br"),e.qZA()()()()),2&n&&(e.xp6(7),e.Q6J("ngIf","admin"===o.userinfo.username||o.userinfo.apps.customer&&o.userinfo.apps.customer.isEdit),e.xp6(5),e.Q6J("ngIf",o.customersData),e.xp6(3),e.Q6J("nzPageIndex",o.index)("nzTotal",o.total)("nzShowSizeChanger",!0)("nzPageSize",o.pageSize))},dependencies:[p.sg,p.O5,T.SY,Z.Ls,z.t3,z.SK,c.Lr,c.Nx,c.iK,c.Fd,l._Y,l.Fj,l.JJ,l.JL,l.nD,l.sg,l.u,d.Zp,d.gB,d.ke,g.Ip,g.Vq,A.ix,v.w,S.dQ,m.N8,m.Uo,m._C,m.Om,m.p0,m.$Z,N.JW,b.dE],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}.customer-form[_ngcontent-%COMP%]{margin-top:20px}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-right[_ngcontent-%COMP%]{text-align:right!important}"]}),t})()}];let q=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.Bz.forChild(M),u.Bz]}),t})(),X=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[p.ez,q,_.m]}),t})()}}]);